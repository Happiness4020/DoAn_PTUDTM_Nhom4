@model DoAn_QLDoDienTu_Web.Models.ChiTietSanPham
@{
    ViewBag.Title = "ChiTietSanPham";
    Layout = "~/Views/Shared/_Main.cshtml";
}
<div class="card mb-3 mx-auto shadow-lg border-2 mt-3" style="max-width: 1024px; border-radius: 8px; background-color: #f8f9fa;">
    <div class="row g-0 mt-1">
        <div class="col-md-12 text-center">
            <div class="card-body">
                <h2 class="text-danger" style="font-weight: bold; font-size: 2.5em;">Chi tiết sản phẩm</h2>
            </div>
        </div>
    </div>

    <div class="row g-0">
        <div class="col-md-6">
            <img id="productImage" src="~/images/@Model.SanPham.Anh" class="img-fluid" alt="Course image" style="width: 100%; height: 100%;">
        </div>
        <div class="col-md-6 d-flex align-items-center p-3 shadow-sm" style="background-color: #0066b3;">
            <div class="card-body">
                <h5 class="card-title mb-2 text-white" style="font-weight: 600; font-size: 1.8em;">@Model.SanPham.TenSanPham</h5>

                <!-- Dropdown chọn màu sắc -->
                <label for="colorSelect" class="text-white">Chọn màu sắc</label>
                <select id="colorSelect" class="form-control mb-3">
                    <option value="">Chọn màu</option>
                </select>

                <!-- Hiển thị giá và mô tả dựa trên màu sắc -->
                <p id="productPrice" class="card-text mb-2 text-white">Giá: <span class="text-warning">@Model.Gia.ToString("N0") VNĐ</span></p>
                <p id="productDescription" class="card-text mb-2 text-white">Mô tả: <span class="text-info">@Model.MoTa</span></p>
            </div>
        </div>
    </div>

    <div class="row g-0">
        <div class="col-md-12">
            <div class="card-body text-white text-justify" style="line-height: 1.6;">
                <p class="card-text mt-3" style="font-size: 1.1em; color: #0066b3">@Model.MoTa</p>
            </div>
        </div>
    </div>
</div>

<script>
    // Chuyển dữ liệu JSON từ ViewBag vào biến JavaScript
    var chiTietSanPham = @Html.Raw(ViewBag.ChiTietSanPhamJson);

    // Populate color dropdown with colors from chiTietSanPham data
    var colorSelect = document.getElementById("colorSelect");
    chiTietSanPham.forEach(function(item) {
        var option = document.createElement("option");
        option.value = item.MauSac;
        option.textContent = item.MauSac;
        colorSelect.appendChild(option);
    });

    // Hàm cập nhật thông tin sản phẩm khi người dùng chọn màu sắc
    function updateProductDetails(color) {
        // Tìm chi tiết sản phẩm dựa trên màu sắc được chọn
        var productDetail = chiTietSanPham.find(item => item.MauSac === color);
        if (productDetail) {
            // Định dạng giá thành dạng 1.000.000 VNĐ
            var formattedPrice = parseInt(productDetail.Gia).toLocaleString('vi-VN');

            // Cập nhật giá và mô tả theo màu
            document.getElementById("productPrice").innerHTML = "Giá: <span class='text-warning'>" + formattedPrice + " VNĐ</span>";
            document.getElementById("productDescription").innerHTML = "Mô tả: <span class='text-info'>" + productDetail.MoTa + "</span>";
        }
    }

    // Lắng nghe sự kiện khi người dùng chọn màu trong dropdown
    colorSelect.addEventListener("change", function() {
        var selectedColor = this.value;
        if (selectedColor) {
            updateProductDetails(selectedColor);
        }
    });
</script>
